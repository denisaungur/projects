<html>
<head>
<style type="text/css">
td {

}
table
{
	border: 1px solid black;

}

</style>

<script type="text/javascript">

var emptyCell;

function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

function generate(){
	var numbers = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
	numbers=shuffle(numbers);
	
	emptyCell = Math.floor(Math.random() * 1000) % 16;
	var j = 0;
	
	var cell;
	for (i = 1; i < 17; i++){
		cell = document.getElementById(i);
		img = document.createElement("img");
		if( i != emptyCell){
			img.setAttribute("src", "img"+numbers[j]+".jpg");
			j++;
		}
		cell.appendChild(img);
	}
}


function move(cellID, cell){
	if(cellID == emptyCell) {
		return;
	}
	
	left = cellID - 1;
	rightC = cellID + 1;
	topC = cellID - 4;
	bottom = cellID + 4;
	if ( emptyCell != left && emptyCell != rightC && emptyCell != topC && emptyCell != bottom){
		return;
	}
	
	newPoz = document.getElementById(emptyCell);
	number = cell.firstChild;
	
	cell.removeChild(cell.firstChild);
	newPoz.appendChild(number);
	
	emptyCell = cellID;
	
}



</script>

</head>
<body onload="generate()">
<table>
<tr >
<td id="1" onclick="move(1, this);"></td>
<td id="2" onclick="move(2, this);"></td>
<td id="3" onclick="move(3, this);"></td>
<td id="4" onclick="move(4, this);"></td>
</tr>
<tr>
<td id="5" onclick="move(5, this);"></td>
<td id="6" onclick="move(6, this);"></td>
<td id="7" onclick="move(7, this);"></td>
<td id="8" onclick="move(8, this);"></td>
</tr>
<tr>
<td id="9" onclick="move(9, this);"></td>
<td id="10" onclick="move(10, this);"></td>
<td id="11" onclick="move(11, this);"></td>
<td id="12" onclick="move(12, this);"></td>
</tr>
<tr>
<td id="13" onclick="move(13, this);"></td>
<td id="14" onclick="move(14, this);"></td>
<td id="15" onclick="move(15, this);"></td>
<td id="16" onclick="move(16, this);"></td>
</tr>
</table>
</body>

</html>